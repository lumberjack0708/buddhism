<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½›æ³•ç¶²ç«™ API æ¸¬è©¦</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .test-section h3 { margin-top: 0; color: #333; }
        input, select, textarea { width: 100%; padding: 8px; margin: 5px 0; box-sizing: border-box; }
        button { background: #007cba; color: white; padding: 10px 20px; border: none; cursor: pointer; border-radius: 3px; }
        button:hover { background: #005a87; }
        .result { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 3px; white-space: pre-wrap; font-family: monospace; }
        .get-links { display: flex; flex-wrap: wrap; gap: 10px; }
        .get-links a { background: #28a745; color: white; padding: 8px 12px; text-decoration: none; border-radius: 3px; font-size: 12px; }
        .get-links a:hover { background: #218838; }
    </style>
</head>
<body>
    <h1>ğŸ•¯ï¸ ä½›æ³•ç¶²ç«™ API æ¸¬è©¦å·¥å…·</h1>
    
    <!-- GET è«‹æ±‚æ¸¬è©¦ -->
    <div class="test-section">
        <h3>ğŸ“‹ GET è«‹æ±‚æ¸¬è©¦ï¼ˆç›´æ¥é»æ“Šæ¸¬è©¦ï¼‰</h3>
        <div class="get-links">
            <a href="index.php?action=scriptures_getAll" target="_blank">å–å¾—æ‰€æœ‰å…¸ç±</a>
            <a href="index.php?action=chapters_getAll" target="_blank">å–å¾—æ‰€æœ‰ç« ç¯€</a>
            <a href="index.php?action=sections_getAll" target="_blank">å–å¾—æ‰€æœ‰å°ç¯€</a>
            <a href="index.php?action=themes_getAll" target="_blank">å–å¾—æ‰€æœ‰ä¸»é¡Œ</a>
            <a href="index.php?action=qa_getAll" target="_blank">å–å¾—æ‰€æœ‰å•ç­”</a>
            <a href="index.php?action=qa_getCategories" target="_blank">å–å¾—å•ç­”åˆ†é¡</a>
            <a href="index.php?action=qa_getAllTags" target="_blank">å–å¾—æ‰€æœ‰æ¨™ç±¤</a>
            <a href="index.php?action=qa_getRandom" target="_blank">å–å¾—éš¨æ©Ÿå•ç­”</a>
        </div>
    </div>

    <!-- å…¸ç±æ¸¬è©¦ -->
    <div class="test-section">
        <h3>ğŸ“š å…¸ç± API æ¸¬è©¦</h3>
        
        <h4>ğŸ” æŸ¥è©¢å…¸ç±</h4>
        <form onsubmit="testAPI(event, this)">
            <input type="hidden" name="action" value="scriptures_getById">
            <label>å…¸ç± ID:</label>
            <input type="text" name="id" placeholder="ä¾‹ï¼šheartSutra" required>
            <button type="submit">æŸ¥è©¢å…¸ç±</button>
        </form>

        <h4>â• æ–°å¢å…¸ç±</h4>
        <form onsubmit="testAPI(event, this)">
            <input type="hidden" name="action" value="scriptures_create">
            <label>å…¸ç± ID:</label>
            <input type="text" name="id" placeholder="ä¾‹ï¼štestScripture" required>
            <label>å…¸ç±åç¨±:</label>
            <input type="text" name="name" placeholder="ä¾‹ï¼šæ¸¬è©¦å…¸ç±" required>
            <label>æè¿°:</label>
            <textarea name="description" placeholder="å…¸ç±æè¿°ï¼ˆé¸å¡«ï¼‰"></textarea>
            <button type="submit">æ–°å¢å…¸ç±</button>
        </form>
    </div>

    <!-- å•ç­”æ¸¬è©¦ -->
    <div class="test-section">
        <h3>â“ å•ç­” API æ¸¬è©¦</h3>
        
        <h4>ğŸ” æœå°‹å•ç­”</h4>
        <form onsubmit="testAPI(event, this)">
            <input type="hidden" name="action" value="qa_search">
            <label>æœå°‹é—œéµå­—:</label>
            <input type="text" name="keyword" placeholder="ä¾‹ï¼šèˆ¬è‹¥" required>
            <button type="submit">æœå°‹å•ç­”</button>
        </form>

        <h4>ğŸ“ æ–°å¢å•ç­”</h4>
        <form onsubmit="testAPI(event, this)">
            <input type="hidden" name="action" value="qa_create">
            <label>å•ç­” ID:</label>
            <input type="text" name="id" placeholder="ä¾‹ï¼štest_qa_1" required>
            <label>åˆ†é¡:</label>
            <input type="text" name="category" placeholder="ä¾‹ï¼šæ¸¬è©¦åˆ†é¡" required>
            <label>å•é¡Œ:</label>
            <textarea name="question" placeholder="å•é¡Œå…§å®¹" required></textarea>
            <label>ç­”æ¡ˆ:</label>
            <textarea name="answer" placeholder="ç­”æ¡ˆå…§å®¹" required></textarea>
            <label>æ¨™ç±¤ (JSON æ ¼å¼):</label>
            <input type="text" name="tags" placeholder='ä¾‹ï¼š["æ¨™ç±¤1", "æ¨™ç±¤2"]'>
            <button type="submit">æ–°å¢å•ç­”</button>
        </form>
    </div>

    <!-- è‡ªå®šç¾©æ¸¬è©¦ -->
    <div class="test-section">
        <h3>ğŸ”§ è‡ªå®šç¾© API æ¸¬è©¦</h3>
        <form onsubmit="testCustomAPI(event)">
            <label>Action:</label>
            <select id="customAction">
                <option value="">é¸æ“‡æˆ–è¼¸å…¥ action</option>
                <optgroup label="å…¸ç±">
                    <option value="scriptures_getAll">scriptures_getAll</option>
                    <option value="scriptures_getById">scriptures_getById</option>
                    <option value="scriptures_search">scriptures_search</option>
                </optgroup>
                <optgroup label="ç« ç¯€">
                    <option value="chapters_getAll">chapters_getAll</option>
                    <option value="chapters_getByScriptureId">chapters_getByScriptureId</option>
                </optgroup>
                <optgroup label="å•ç­”">
                    <option value="qa_getAll">qa_getAll</option>
                    <option value="qa_getByCategory">qa_getByCategory</option>
                    <option value="qa_search">qa_search</option>
                </optgroup>
            </select>
            <label>é¡å¤–åƒæ•¸ (JSON æ ¼å¼):</label>
            <textarea id="customParams" placeholder='ä¾‹ï¼š{"id": "heartSutra", "keyword": "èˆ¬è‹¥"}'></textarea>
            <button type="submit">åŸ·è¡Œæ¸¬è©¦</button>
        </form>
    </div>

    <!-- çµæœé¡¯ç¤º -->
    <div class="test-section">
        <h3>ğŸ“Š æ¸¬è©¦çµæœ</h3>
        <div id="result" class="result">ç­‰å¾…æ¸¬è©¦çµæœ...</div>
    </div>

    <script>
        function testAPI(event, form) {
            event.preventDefault();
            
            const formData = new FormData(form);
            
            fetch('index.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('result').textContent = JSON.stringify(data, null, 2);
            })
            .catch(error => {
                document.getElementById('result').textContent = 'éŒ¯èª¤: ' + error.message;
            });
        }

        function testCustomAPI(event) {
            event.preventDefault();
            
            const action = document.getElementById('customAction').value;
            const paramsText = document.getElementById('customParams').value;
            
            if (!action) {
                alert('è«‹é¸æ“‡æˆ–è¼¸å…¥ action');
                return;
            }
            
            const formData = new FormData();
            formData.append('action', action);
            
            if (paramsText) {
                try {
                    const params = JSON.parse(paramsText);
                    for (const [key, value] of Object.entries(params)) {
                        formData.append(key, value);
                    }
                } catch (e) {
                    alert('åƒæ•¸ JSON æ ¼å¼éŒ¯èª¤');
                    return;
                }
            }
            
            fetch('index.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('result').textContent = JSON.stringify(data, null, 2);
            })
            .catch(error => {
                document.getElementById('result').textContent = 'éŒ¯èª¤: ' + error.message;
            });
        }
    </script>
</body>
</html> 